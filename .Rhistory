knitr::opts_chunk$set(echo = TRUE)
set.seed(1)
data = read.csv("adult.csv")
summary(data)
cols_missing_vals <- c("occupation", "workclass", "native.country")
for (column in cols_missing_vals) {
data <- data[!grepl("\\?", data[, column]),]
}
summary(data)
### 1. Class  (<=50K or 50K>)
data$class_dummy = ifelse(data$class==" <=50K",0,1) # Our Response Variable. I made 0 for below 50K and 1 for above 50K
### 2. Sex  (Female, Male)
data$sex_dummy = ifelse(data$sex==" Female",0,1)
### 3. Workclass
data$workclass_dummy = ifelse(data$workclass==" Private",0,
ifelse(data$workclass==" State-gov",1,
ifelse(data$workclass ==" Federal-gov",2,
ifelse(data$workclass == " Self-emp-not-inc",3,
ifelse(data$workclass==" Self-emp-inc",4,
ifelse(data$workclass==" Local-gov",5,6)))))) #
### 4. Marital Status
data$marital.status_dummy = ifelse(data$marital.status == " Widowed",0,
ifelse(data$marital.status == " Divorced",1,
ifelse(data$marital.status == " Separated",2,
ifelse(data$marital.status == " Never-married",3,
ifelse(data$marital.status== " Married-civ-spouse",4,
ifelse(data$marital.status==" Married-AF-spouse",4,5
))))))
### 5. Race
data$race_dummy = ifelse(data$race ==" White",0,
ifelse(data$race == " Black",1,
ifelse(data$race==" Asian-Pac_islander",2,
ifelse(data$race==" Amer-Indian-Eskimo",3,4))))
### 6. Relationship
data$relationship_dummy = ifelse(data$relationship==" Husband",1,
ifelse(data$relationship==" Wife",1,0))
### 7. Education
# I grouped them by following:
# 0 means all students who are in 1st to 12 grade
# 1 means all students who are in HS-grad, Assos-acdm, Prof-school
# 2 means all students who are in Bachelors Degree
# 3 means all students who are in Masters' Degree
# 4 means all students who are in Doc
# and 5 means UNKNOWNs
data$education_dummy=ifelse(data$education==" Prepschool",0,
ifelse(data$education==" 1st-4th",0,
ifelse(data$education== "5th-6th",0,
ifelse(data$education==" 7th-8th",0,
ifelse(data$education==" 9th",0, ifelse(data$education==" 10th",0,
ifelse(data$education==" 11th",0,
ifelse(data$education==" 12th",0,
ifelse(data$education==" HS-grad",1,
ifelse(data$education==" Assos-voc", 1,
ifelse(data$education==" Assoc-acdm",1,
ifelse(data$education==" Prof-school",1,
ifelse(data$education==" Some-college",1,
ifelse(data$education==" Bachelors",2,
ifelse(data$education==" Masters",3,
ifelse(data$education==" Doctorate",4, 5))))))))))))))))
print(data$education_dummy)
### 8. Native Country
data$native.country_dummy = ifelse(data$native.country==" United-States",0,1)
# So most people are from the United States, so I assigned them to 0 and other countries to 1
# Omit NA rows
data = na.omit(data)
sample <- sample(c(TRUE, FALSE), nrow(data), replace=TRUE, prob=c(0.8,0.2))
train  <- data[sample, ]
test   <- data[!sample, ]
print(nrow(train))
print(nrow(test))
library(tree)
plot.new()
class.tree = tree(class_dummy ~ native.country_dummy+education_dummy+relationship_dummy+race_dummy+marital.status_dummy+workclass_dummy+sex_dummy+capital.loss+capital.gain+age, data=train)
summary(class.tree)
plot(class.tree)
text(class.tree)
class.cv = cv.tree(class.tree,FUN = prune.misclass)
summary(data)
